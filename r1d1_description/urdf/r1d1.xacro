<?xml version="1.0" ?>
<robot name="r1d1" xmlns:xacro="http://www.ros.org/wiki/xacro">

<xacro:include filename="$(find r1d1_description)/urdf/materials.xacro" />
<xacro:include filename="$(find r1d1_description)/urdf/r1d1.trans" />
<xacro:include filename="$(find r1d1_description)/urdf/r1d1.gazebo" />

 
<link name = "base_link">
</link>

<link name="agv">
  <inertial>
    <origin xyz="-0.056878424157251854 0.0008246628795467839 0.818040188158863" rpy="0 0 0"/>
    <mass value="55.61253674388458"/>
    <inertia ixx="13.411535" iyy="13.340011" izz="0.936169" ixy="-0.003638" iyz="-0.013402" ixz="0.58154"/>
  </inertial>
  <visual>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/base_link.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/base_link.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="linear_1">
  <inertial>
    <origin xyz="-0.012901256911776852 -0.046411206179637836 -0.09597589005727636" rpy="0 0 0"/>
    <mass value="2.084942989538732"/>
    <inertia ixx="0.009769" iyy="0.004571" izz="0.006521" ixy="-2.1e-05" iyz="5e-06" ixz="0.0"/>
  </inertial>
  <visual>
    <origin xyz="-0.005999 -0.0445 -1.067874" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/linear_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="-0.005999 -0.0445 -1.067874" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/linear_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="left_wheel_1">
  <inertial>
    <origin xyz="-1.8590005809345583e-14 0.08192204264568177 5.28692032052136e-06" rpy="0 0 0"/>
    <mass value="3.081377574152813"/>
    <inertia ixx="0.005627" iyy="0.009529" izz="0.005627" ixy="-0.0" iyz="1e-06" ixz="-0.0"/>
  </inertial>
  <visual>
    <origin xyz="-0.0 -0.105 -0.085" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/left_wheel_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="-0.0 -0.105 -0.085" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/left_wheel_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="right_wheel_1">
  <inertial>
    <origin xyz="2.564806735050329e-12 -0.0819220426456198 5.286920330679901e-06" rpy="0 0 0"/>
    <mass value="3.0813775741527913"/>
    <inertia ixx="0.005627" iyy="0.009529" izz="0.005627" ixy="0.0" iyz="-1e-06" ixz="-0.0"/>
  </inertial>
  <visual>
    <origin xyz="-0.0 0.105 -0.085" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/right_wheel_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="-0.0 0.105 -0.085" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/right_wheel_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="c2_1">
  <inertial>
    <origin xyz="-0.01491487073474762 -0.01482504533854448 -0.043955842704183706" rpy="0 0 0"/>
    <mass value="0.4724977724162874"/>
    <inertia ixx="0.00053" iyy="0.000531" izz="0.000293" ixy="-5.7e-05" iyz="-0.000116" ixz="-0.000117"/>
  </inertial>
  <visual>
    <origin xyz="-0.152 -0.0925 -0.093274" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/c2_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="-0.152 -0.0925 -0.093274" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/c2_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="c3_1">
  <inertial>
    <origin xyz="0.014825194849290818 -0.014914492449113803 -0.043955666652084724" rpy="0 0 0"/>
    <mass value="0.47250060064442484"/>
    <inertia ixx="0.000531" iyy="0.00053" izz="0.000293" ixy="5.7e-05" iyz="-0.000117" ixz="0.000116"/>
  </inertial>
  <visual>
    <origin xyz="-0.152017 0.092317 -0.093274" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/c3_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="-0.152017 0.092317 -0.093274" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/c3_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="c1_1">
  <inertial>
    <origin xyz="-0.014914870744570902 -0.014825045338495546 -0.043955842704183706" rpy="0 0 0"/>
    <mass value="0.4724977724162867"/>
    <inertia ixx="0.00053" iyy="0.000531" izz="0.000293" ixy="-5.7e-05" iyz="-0.000116" ixz="-0.000117"/>
  </inertial>
  <visual>
    <origin xyz="0.15 -0.094 -0.093274" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/c1_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.15 -0.094 -0.093274" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/c1_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="c4_1">
  <inertial>
    <origin xyz="0.014825117999609755 -0.014914868218551092 -0.043955666652084655" rpy="0 0 0"/>
    <mass value="0.4725006006444246"/>
    <inertia ixx="0.000531" iyy="0.00053" izz="0.000293" ixy="5.7e-05" iyz="-0.000117" ixz="0.000116"/>
  </inertial>
  <visual>
    <origin xyz="0.15 0.094 -0.093274" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/c4_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin xyz="0.15 0.094 -0.093274" rpy="0 0 0"/>
    <geometry>
      <mesh filename="file://$(find r1d1_description)/meshes/c4_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="laser_frame">
    <visual>
        <geometry>
            <cylinder radius="0.05" length="0.04"/>
        </geometry>
        <material name="red"/>
    </visual>
    <collision>
        <geometry>
            <cylinder radius="0.05" length="0.04"/>
        </geometry>
    </collision>
    
</link>
<link name = "base_footprint">
</link>


<joint name="slider" type="prismatic">
  <origin xyz="0.005999 0.0445 1.067874" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="linear_1"/>
  <axis xyz="0.0 -0.0 -1.0"/>
  <limit upper="0.5" lower="-0.7" effort="100" velocity="100"/>
</joint>

<joint name="left_wheel_joint" type="continuous">
  <origin xyz="0.0 0.105 0.085" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="left_wheel_1"/>
  <axis xyz="-0.0 1.0 0.0"/>
</joint>

<joint name="right_wheel_joint" type="continuous">
  <origin xyz="0.0 -0.105 0.085" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="right_wheel_1"/>
  <axis xyz="0.0 1.0 0.0"/>
</joint>

<joint name="Revolute 20" type="continuous">
  <origin xyz="0.152 0.0925 0.093274" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="c2_1"/>
  <axis xyz="0.0 0.0 1.0"/>
</joint>

<joint name="Revolute 21" type="continuous">
  <origin xyz="0.152017 -0.092317 0.093274" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="c3_1"/>
  <axis xyz="0.0 0.0 1.0"/>
</joint>

<joint name="Revolute 22" type="continuous">
  <origin xyz="-0.15 0.094 0.093274" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="c1_1"/>
  <axis xyz="0.0 0.0 1.0"/>
</joint>

<joint name="Revolute 23" type="continuous">
  <origin xyz="-0.15 -0.094 0.093274" rpy="0 0 0"/>
  <parent link="base_link"/>
  <child link="c4_1"/>
  <axis xyz="0.0 0.0 1.0"/>
</joint>

<joint name="laser_joint" type="fixed">
        <parent link="agv"/>
        <child link="laser_frame"/>
        <origin xyz="0.2 0 0.24" rpy="0 0 0"/>
</joint>
<joint name = "base_footprint_joint" type="fixed">
    <parent link="base_link"/>
    <child  link="base_footprint"/>
    <origin xyz="0 0 0" rpy="0 0 0 "/>
  </joint>
<joint name = "agv_joint" type="fixed">
    <parent link="base_link"/>
    <child  link="agv"/>
    <origin xyz="0 0 0" rpy="0 0 0 "/>
  </joint>

<ros2_control name="GazeboSystem" type="system">
  <hardware>
    <plugin>gazebo_ros2_control/GazeboSystem</plugin>
  </hardware>
  <joint name="slider">
    <command_interface name="position">
      <param name="min">-0.7</param>
      <param name="max">0.5</param>
    </command_interface>
    <state_interface name="position">
      <param name="initial_value">-0.7</param>
    </state_interface>
    <state_interface name="velocity"/>
    <state_interface name="effort"/>
  </joint>
  <joint name="left_wheel_joint">
        <command_interface name="velocity">
            <param name="min">-10</param>
            <param name="max">10</param>
        </command_interface>
        <state_interface name="position" />
        <state_interface name="velocity" />
    </joint>
    <joint name="right_wheel_joint">
        <command_interface name="velocity">
            <param name="min">-10</param>
            <param name="max">10</param>
        </command_interface>
        <state_interface name="velocity" />
        <state_interface name="position" />
    </joint>
</ros2_control>
<gazebo>
  <plugin filename="libgazebo_ros2_control.so" name="gazebo_ros2_control">
    <parameters>$(find r1d1_description)/config/r1d1.yaml</parameters>
  </plugin>
</gazebo>
<gazebo reference="laser_frame">
        <material>Gazebo/Red</material>
 
        <sensor name="laser" type="ray">
            <pose> 0 0 0 0 0 0 </pose>
            <visualize>true</visualize>
            <update_rate>10</update_rate>
            <ray>
                <scan>
                    <horizontal>
                        <samples>720</samples>
                        <min_angle>-1.57</min_angle>
                        <max_angle>1.57</max_angle>
                    </horizontal>
                </scan>
                <range>
                    <min>0.3</min>
                    <max>12</max>
                </range>
            </ray>
            <plugin name="laser_controller" filename="libgazebo_ros_ray_sensor.so">
                <ros>
                    <argument>~/out:=scan</argument>
                </ros>
                <output_type>sensor_msgs/LaserScan</output_type>
                <frame_name>laser_frame</frame_name>
            </plugin>
        </sensor>
    </gazebo>

</robot>
